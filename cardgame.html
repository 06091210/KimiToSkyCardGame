<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>山札のドラッグ</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    position: relative;
    height: 100vh;
  }
  #deck {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 100px;
    cursor: pointer;
    user-select: none;
  }
  #card {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 100px;
    display: none;
    cursor: grab;
    user-select: none;
    z-index: 10;
  }
</style>
</head>
<body>

<img id="deck" src="images/brank.jpeg" alt="山札" />
<img id="card" src="images/card.png" alt="カード" />

<script>
  const deck = document.getElementById('deck');
  const card = document.getElementById('card');

  deck.addEventListener('click', () => {
    // 山札をクリックしたらカードを表示
    card.style.display = 'block';

    // カードを山札の位置にリセット
    card.style.top = deck.style.top;
    card.style.right = deck.style.right;
    card.style.left = '';  // right指定に合わせてleftは空に
    card.style.cursor = 'grab';
  });

  let isDragging = false;
  let offsetX = 0;
  let offsetY = 0;

  card.addEventListener('mousedown', (e) => {
    isDragging = true;
    card.style.cursor = 'grabbing';

    // マウス位置とカードの左上の位置の差を記録
    const rect = card.getBoundingClientRect();
    offsetX = e.clientX - rect.left;
    offsetY = e.clientY - rect.top;
  });

  window.addEventListener('mouseup', () => {
    if (isDragging) {
      isDragging = false;
      card.style.cursor = 'grab';
    }
  });

  window.addEventListener('mousemove', (e) => {
    if (!isDragging) return;

    // ドラッグ中はカードの位置を更新（left, topを使う）
    // 右固定を解除し左固定に切り替え
    card.style.right = '';
    let left = e.clientX - offsetX;
    let top = e.clientY - offsetY;

    // 画面内に収める制限もつける（任意）
    left = Math.max(0, Math.min(window.innerWidth - card.offsetWidth, left));
    top = Math.max(0, Math.min(window.innerHeight - card.offsetHeight, top));

    card.style.left = left + 'px';
    card.style.top = top + 'px';
  });
</script>

</body>
</html>
